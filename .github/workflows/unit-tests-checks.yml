name: Cron Job Tests
on:
  schedule:
    - cron: "0 * * * *" 
  workflow_dispatch:
jobs:
  execute-tests:
    if: github.event_name != 'schedule' || vars.ENABLE_CRON == 'true'
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: Set up JDK 23
      uses: actions/setup-java@v4
      with:
        java-version: '23'
        distribution: 'temurin'
        cache: maven
    - name: Test with Maven
      run: mvn test

    - name: Send email on success
      if: success()
      uses: dawidd6/action-send-mail@v3
      with:
        server_address: ${{ vars.SMTP_SERVER }}
        server_port: ${{ vars.SMTP_PORT }}
        username: ${{ vars.MAIL_USERNAME }}
        password: ${{ secrets.MAIL_PASSWORD }}
        subject: "âœ… Maven tests succeeded"
        body: |
          Maven tests completed successfully.
          
          Repository: ${{ github.repository }}
          Branch: ${{ github.ref_name }}
          Commit: ${{ github.sha }}
        to: ${{ vars.EMAIL_TO }}
        from: ${{ vars.EMAIL_FROM }}
          
